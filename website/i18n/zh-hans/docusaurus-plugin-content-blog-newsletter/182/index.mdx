---
slug: /182
title: "This Week In React #182: v18.3, useDeferredValue, Next.js, DevTools, Zustand, CSS-in-JS, R19, Remix, Jest, XState, Astro, RNSC, Strict DOM, 3D, Metro, Worklets, TC39, TypeScript, Effect, Rspack, GraphQL..."
authors: [slorber, bndkt]
date: 04-17-2024
---

大家好！

本周我们迎来了不错的 Next.js 版本发布以及许多有趣的社区博客文章。

我们也能感受到 React 核心团队正在努力完善 React 19 的剩余细节。出人意料的是，最终计划推出 v18.3 版本并包含额外警告。React Native 0.74 也即将发布。

本周我想向大家介绍 [**ECMAScript News**](https://ecmascript.news/?utm_source=thisweekinreact)。这是我最喜欢的通讯，用于及时了解 ES、TC39、JS 工具和运行时的最新动态。

下周我们将在巴黎举办 [React Connection](https://reactconnection.io/) 和 [React Native Connection](https://reactnativeconnection.io/) 会议。参加的各位，我们届时见 👋。您仍可使用我的合作伙伴代码 "TWIR" 获取 [-20% 折扣](https://www.billetweb.fr/react-connection-2024?discount=TWIR)。

<!-- truncate -->

**💡 [在 Twitter 上查看此通讯](https://slo.im/thread) - 可视化格式 🎨**

---

import Support from "@site/newsletter/_support.mdx";

<Support />

---

## 💸 赞助商 {#sponsor1}

[![React-admin：B2B 应用的开源框架](/emails/issues/182/marmelab.jpg)](https://marmelab.com/react-admin/)

**[React-admin：B2B 应用的开源框架](https://marmelab.com/react-admin/)**

被 25,000 家公司使用，React-admin 是使用 React 构建 ERP、内部工具和 B2B 应用的领先框架。以下是尝试它的三个理由：

1️⃣ **快速开发** 🏎️🏁 拥有超过 170 个钩子和组件的库，让您专注于应用的独特功能而非重复的 CRUD 操作。

2️⃣ **可定制可扩展** ✨💫 基于无头核心构建，支持完全自定义应用外观。在需要自定义逻辑时也不会碍事。

3️⃣ **内置最佳实践** 🤓 集成了 7 年数据获取、性能、表单处理和安全方面的经验，确保稳健愉悦的开发体验。

最重要的是：完全免费且可与 API 无缝集成（无 [SSO 税](https://sso.tax/)）。[**立即尝试**](https://marmelab.com/react-admin/) 😉

---

## ⚛️ React {#react}

[![Next.js 14.2](/emails/issues/182/next14.2.jpg)](https://nextjs.org/blog/next-14-2)

[**Next.js 14.2**](https://nextjs.org/blog/next-14-2)

在 React 19 和 Next.js 15 到来前，这个次要版本包含开发、生产和缓存方面的改进。主要亮点：

- Turbopack (RC)：`next dev --turbo` 测试通过率达 99.8%
- 构建/生产改进：减少内存占用
- 缓存改进：通过 `staleTimes` 可配置客户端缓存重新验证
- 错误 DX：优化水合不匹配错误信息

很高兴看到 Next.js 已实现出色的 React 水合不匹配错误提示！撰写本文时，Turbopack 开发使用准备度达 99.9%（仅缺 6 项测试）。构建功能完成度 75%，还需稍作等待。

---

- 💸 [Clerk - A complete suite of embeddable UIs, flexible APIs, and admin dashboards to authenticate and manage your users.](https://go.clerk.com/JTqLYDZ)
- 👀 [React Core - Upcoming v18.3 release](https://github.com/facebook/react/pull/28843): The React team has finally decided to release a v18 minor version. It should not contain any behavior change but will emit new warnings for deprecated features to help us upgrade to React 19. It should warn us when using string refs, defaultProps on FC/memo components, or when spreading a key prop (🐦 [preview](https://twitter.com/sebastienlorber/status/1780519349247205589)).
- 👀 [React Core - useDeferredValue’s `initialValue`](https://github.com/reactjs/react.dev/pull/6747): In upcoming React 19 canary releases, this hook will take a new 2nd argument affecting the initial render. It will return the `initialValue` on initial render, and schedule a re-render in the background with the `value` returned.
- 👀 [React Core - Automatically reset forms after action finishes](https://github.com/facebook/react/pull/28804): This new React 19 behavior only affects uncontrolled inputs, and aligns with the native platform behavior (it will now be the same with/without JS). It will only affect uncontrolled inputs. They also added a new public API [DOM.requestFormReset](https://github.com/facebook/react/pull/28809) so that form abstraction authors can implement this behavior too.
- 👀 [React Core - DevTools v5.1](https://github.com/facebook/react/pull/28840)
- 👀 [React Core - Document new react-reconciler methods](https://github.com/facebook/react/pull/28750)
- 🗓 [React Summit](https://reactsummit.com/?utm_source=thisweekinreact) - 🇳🇱 Amsterdam - 14-18 June - Get a 10% discount with code "TWIR". Awesome lineup including Evan Bacon, Kent C. Dodds, Theo, Tim Neutkens, Mark Erikson, Fred Schott and so many others!
- 📜 [Zustand and React Context](https://tkdodo.eu/blog/zustand-and-react-context): I cannot agree more with Dominik that suggests putting your Zustand store instance in a React context. This way, you can initialize the store from props, make things easier to test, and allow using a store on multiple subtrees.
- 📜 [CSS in React Server Components](https://www.joshwcomeau.com/react/css-in-rsc/): Josh explains why Styled-Components/Emotion do not play well with RSC, and presents alternative solutions providing a similar styled API, like Linaria, Panda, or Pigment. Avoid FOMO, there's no need to adopt RSCs and these libraries now if your app already works fine.
- 📜 [R19, a dead-simple React 19 framework - Part 2 - The Code; How it works under the hood!](https://www.cmrg.me/blog/rsc-part-2-the-code): Great technical deep dive into what it takes to create a custom React 19 / RSC / Server Actions setup on top of Bun.
- 📜 [Rebuilding "Remix Contacts" in Next.js 14 with Transitions, Server Actions and Prisma](https://aurorascharff.no/posts/rebuilding-remix-contacts-in-nextjs-14-with-transitions-server-actions-and-prisma/): A nicely detailed walkthrough of converting an official Remix tutorial app to Next.js while preserving the progressive enhancement behavior. It also explains the differences between the 2 approaches and lists the pros/cons of each implementation. There’s no clear winner, although Remix looks quite competitive!
- 📜 [The Two-Tree Problem with Styling on the Web](https://danielnagy.me/posts/Post_jt4adn0o5bnr): An interesting read on the DOM/CSS tree separation, and whether React CSS-in-JS or Tailwind solves this problem. The author is pro-inline-style (like me BTW).
- 📜 [Improving our Jest execution time by 300%](https://www.camggould.com/posts/Jest-With-RTL-Is-Slow/): Investigations of Jest execution time on a React codebase. RTL getByRole was a bottleneck, among other things.
- 📜 [Empathetic Coding - Button Component](https://react-japan.dev/en/blog/empathetic-coding-button-component): Nice article showing the steps to design a React button component using TypeScript and Tailwind, keeping in mind maintenance and convenience.
- 📜 [Overcoming Next.js' Search Params Limitation in Layouts](https://www.nico.fyi/blog/workaround-layout-has-no-search-params): Suggest using parallel routes to overcome the limitation.
- 📜 [The process.env frontend time bomb (plus: a sustainable definition of “fixed”)](https://massimilianomirra.com/notes/the-frontend-process-env-time-bomb-plus-a-sustainable-definition-of-fixed): Instead of spreading process.env across your codebase, parses env variables with Zod and exposes app config in a React context.
- 📜 [How to Style a React Application](https://alexkondov.com/full-stack-tao-styling/)
- 📜 [Understanding Layout and Template Next.js App Router](https://www.nico.fyi/blog/understanding-layout-and-template-next-app-router)
- 📦 [Next.js View Transitions](https://next-view-transitions.vercel.app/): Shu from Vercel released a basic userland implementation of CSS View Transitions, although it looks possible that Next.js will provide this feature later.
- 📦 [XState Store](https://stately.ai/blog/2024-04-10-xstate-store): New tiny typesafe event-driven state manager, including a React useSelector API. This reminds me a bit of both Redux and Zustand.
- 📦 [Astro 4.6 - Manual i18n routing, move dev toolbar, CSRF protection, cookies…](https://astro.build/blog/astro-460/)
- 📦 [Next-Video 1.0 - The easiest way to add video in your NextJS app](https://github.com/muxinc/next-video/releases/tag/v1.0.0)
- 📦 [Mantine 7.8.0 - Uncontrolled form mode, form.getValues, form.watch, automatic px to rem conversions](https://mantine.dev/changelog/7-8-0/)
- 📦 [NextUI 2.3 - Date/Time/Calendar components](https://nextui.org/blog/v2.3.0)
- 🎥[Theo - From 0 to Production - The Modern React Tutorial (RSCs, Next.js, Shadui, Drizzle, TS and more)](https://www.youtube.com/watch?v=d5x0JCZbAJs)
- 🎥 [React Paris 2024 - Conf Talks YouTube Playlist](https://www.youtube.com/playlist?list=PL53Z0yyYnpWhUzgvr2Nys3kZBBLcY0TA7)
- 🎥 [Ryan Toronto - Handling RSC Errors in Next.js](https://www.youtube.com/watch?v=idEL0dv2V1A)

<SubscribeFormEmbed placement="middle" />

---

## 💸 赞助 {#sponsor2}

[![React 的 FormBuilder SDK](/emails/issues/171/tripetto.jpg)](https://tripetto.com/sdk/this-week-in-react/?utm_source=thisweekinreact&utm_medium=sponsor&utm_campaign=sdk)

**[React 的 FormBuilder SDK](https://tripetto.com/sdk/this-week-in-react/?utm_source=thisweekinreact&utm_medium=sponsor&utm_campaign=sdk)**

专为 React 项目设计的完整表单解决方案，已被财富 500 强企业采用。提供易于使用的开源组件，可在 React 应用中快速构建和运行强大的表单。文档详尽，支持分钟级部署，并具备深度定制能力。

- 表单构建器：创建功能强大的表单；
- 表单运行器：部署表单并收集数据；
- 灵活的表单布局（对话式、聊天式等）和样式；
- 支持自定义问题类型扩展；
- 提供完整文档、示例和演示；
- 自托管无外部依赖；
- 免费开始、测试和完善。

TWIR 专属优惠：[获取 FormBuilder SDK 许可证 25% 折扣](https://tripetto.com/sdk/this-week-in-react/?utm_source=thisweekinreact&utm_medium=sponsor&utm_campaign=sdk)。

---

## 📱 React-Native {#react-native}

[![React Native 中能否实现零打包体积的 React 服务器组件？](/emails/issues/182/rn0kb.jpg)](https://twitter.com/Baconbrix/status/1780259340458340360)

🐦 [React Native 中能否实现零打包体积的 React 服务器组件？](https://twitter.com/Baconbrix/status/1780259340458340360)

Evan Bacon 给出了肯定的回答，并让我们一窥在由服务器驱动的 React Native 世界中未来可能的样子。激动人心的时刻即将到来！

---

- 💸 [PowerSync – 通过简化的状态管理和实时响应性构建本地优先应用。对现有架构无侵入性。](https://www.powersync.com/?utm_source=newsletter&utm_medium=sponsorship&utm_campaign=this-week-in-react)
- 🐦 [Brent Vatne的自动批处理演示](https://twitter.com/notbrent/status/1778266063832056285)：观看新架构的实际运行！
- 🐦 [针对破坏性操作的优雅对话框组件演示](https://twitter.com/marceloterreiro/status/1779657639745798411)
- 🐦 [Ignite Cookbook网站悄然新增多个配方](https://twitter.com/jamonholmgren/status/1778829659775676653)：Supabase & PowerSync
- 🐦 [在Vision Pro上使用RN进行3D渲染](https://twitter.com/o_kwasniewski/status/1780602815167283485)
- 👀 [rn.new - 启动React Native项目的绝佳方式](https://rn.new)
- 🗓 [App.js Conf](https://appjs.co/?utm_source=thisweekinreact) - 🇵🇱 克拉科夫 - 5月22-24日。使用代码"TWIR"获取[10%折扣](https://ti.to/appjs/2024/discount/TWIR)。
- 📜 [使用React、Expo和ThreeJS为3D动画添加形状与纹理](https://www.themorrow.digital/blog/add-shapes-and-textures-to-3d-animations-with-react-expo-and-threejs)：上周我介绍了即将推出的3D动画库，当然RN中已有现成的3D实现方案。本文描述了其中一种方法。
- 📜 [如何实现Metro的HTTP缓存](https://andrei-calazans.com/posts/metro-http-cache/)：您知道吗？Meta为其RN开发者使用中央缓存，这意味着当某位开发者已打包某资源时，其他开发者可直接复用缓存结果。本文详述Metro远程HTTP缓存的工作原理。
- 📜 [React Strict DOM：基于React Native的通用应用未来](https://blog.theodo.com/2024/04/react-strict-dom-react-native-web/)
- 📜 [被遗忘的状态栏设计艺术](https://brainsandbeards.com/blog/2024-forgotten-art-of-status-bar-design/)
- 📜 [Gist - 使用Expo 50.0.17实现Apple隐私清单](https://gist.github.com/catalinmiron/d2cabb835088d0342bc48030464ee615)
- 📜 [react-native-worklets-core 1.0](https://github.com/margelo/react-native-worklets-core/releases/tag/v1.0.0)
- 📦 [VisionCamera 4.0.0-beta.15 - 支持Skia帧处理器的首个测试版](https://github.com/mrousavy/react-native-vision-camera/releases/tag/v4.0.0-beta.15)
- 📦 [react-native 0.74.0-rc.9](https://github.com/facebook/react-native/releases/tag/v0.74.0-rc.9)：为构建步骤添加iOS隐私清单模板
- 📦 [Unistyle 2.6 + 2.7 - 新增tvOS与visionOS支持](https://github.com/jpudysz/react-native-unistyles/releases)
- 📦 [RN Storybook v8.0.0-alpha.4](https://github.com/storybookjs/react-native/releases/tag/v8.0.0-alpha.4)
- 🎥 [Simon Grimm - 十大顶尖React Native动画库](https://www.youtube.com/watch?v=8CZy6DjDXK0)
- 🎥 [应用体积至关重要 | React Native优化短片2](https://www.youtube.com/watch?v=d2xlQRoea-8)
- 🎙️ [火箭飞船38期 - Expo EAS与Jon Samp的100条蛇](https://share.transistor.fm/s/6896005f)

---

## 🔀 其他 {#other}

- 📜 [第101届TC39会议更新 - Set方法、正则表达式、Promise.try、isError、Signals...](https://dev.to/hemanth/updates-from-the-101th-tc39-meeting-1mm)
- 📜 [TypeScript功能实现：类型谓词推断](https://effectivetypescript.com/2024/04/16/inferring-a-type-predicate/)
- 📜 [Deno - JSR构建历程](https://deno.com/blog/how-we-built-jsr)
- 📜 [你可能不需要GraphQL](https://mxstbr.com/thoughts/graphql)
- 📜 [Node.js协作峰会（2024伦敦站）](https://nodejs.org/en/blog/events/collab-summit-2024-london)
- 📜 [Rspack与Webpack Tree Shaking深度解析](https://github.com/orgs/web-infra-dev/discussions/17)
- 📦 [Safari技术预览版192 - CSS视图过渡、URL.parse()](https://webkit.org/blog/15260/release-notes-for-safari-technology-preview-192/)
- 📦 [Rspack v0.6 - 内置CSS提取插件、启用全新Tree Shaking](https://www.rspack.dev/blog/announcing-0.6.html)
- 📦 [pnpm 9.0 - 放弃Node 16支持、改进lockfile格式与解析](https://github.com/pnpm/pnpm/releases/tag/v9.0.0)
- 📦 [Biome 1.7 - 增强ESLint/Prettier迁移CLI](https://biomejs.dev/blog/biome-v1-7/)
- 📦 [Effect 3.0 - API稳定版](https://effect.website/blog/effect-3.0)
- 📦 [gql.tada 1.5 - 持久化操作、Turbo模式、全新CLI](https://gql-tada.0no.co/devlog/2024-04-15)

---

## 🤭 趣事 {#fun}

[![alt](/emails/issues/182/meme.jpg)](https://twitter.com/bndkt/status/1780615189202907426)

再见！👋