---
slug: /121
title: "This Week In React #121: Next.js, experimental_cache, CSS-in-JS, Qwikify, Typesafety, 3D, Vitest Preview, Outstatic, Remix, React-Native..."
authors: [slorber]
date: 10-25-2022
---

大家好！

上周我犯了个错误，把第220期错发成了120期 😅 似乎没人注意到，应该问题不大！

现在是会议季：ViteConf回放已上线，React Advanced刚结束，更多活动即将到来。

Next.js大会几小时后开始。我们可能会看到Next.js 13的发布，包含嵌套布局(nested layouts)，以及一些以Turbo开头的超酷功能🤭。下周再详聊。

同时所有托管平台都宣布将增强Next.js支持：Netlify、Cloudflare、Microsoft...

别忘了William Candillon的React Native第五季视频今天开播！

我上个月在[PodRocket录制了关于Docusaurus 2.0的播客](https://podrocket.logrocket.com/docusaurus)，完全忘记提这事了😅 未来想参与更多播客，欢迎邀请我！😉

<!-- truncate -->

**💡 [在Twitter查看本期简讯](https://slo.im/thread) - 可视化格式 🎨**

---

import Support from "@site/newsletter/_support.mdx";

<Support />

---

## 💸 赞助 {#sponsor1}

[![Sizzy - 开发者专属浏览器](/emails/issues/220/sizzy.jpg)](https://sizzy.co/?utm_campaign=newsletter&utm_source=thisweekinreact)

为什么其他行业的专业人士都有专用工具，而Web开发者还在用奶奶网购的浏览器？

如果你在Sizzy之外的浏览器打开localhost:3000，就是在浪费宝贵时间。

**使用Sizzy前**：Web开发令人焦虑，响应式设计困难重重，标签页和应用堆积如山。

**使用Sizzy后**：所需工具集成一体，响应式设计轻而易举，无需频繁切换环境。

立即[点击下载](https://sizzy.co/?utm_campaign=newsletter&utm_source=thisweekinreact)，享受14天免费试用！

---

## ⚛️ React {#react}

**[为什么我们要放弃CSS-in-JS](https://dev.to/srmagura/why-were-breaking-up-wiht-css-in-js-4g9b)**

Emotion维护者Sam分析了CSS-in-JS的优缺点，重点指出运行时库的问题。对他公司Spot而言，样式序列化的成本过高。他们用Sass模块(CSS模块+Sass)和CSS工具系统替代了Emotion。在Docusaurus中，我们也使用CSS模块，可以确认这是无运行时且相对简单的替代方案。开发体验虽不如前者，但完全可以接受。

此文引发热议。运行时CSS-in-JS库的性能问题早已为人所知。[Dan Abramov证实](https://twitter.com/dan_abramov/status/1584835028986793984)并[表示不愿在新版React文档站点使用任何运行时](https://github.com/reactjs/reactjs.org/issues/5115)。Ryan Florence提到[使用Emotion的Chakra存在性能问题](https://twitter.com/ryanflorence/status/1582835729360572416)。

Tailwind 仍是一个不错的替代方案。在我看来，它可以归类为无运行时的 CSS-in-JJS 方案，特别是在 React 环境中通过 JSX 实现 Tailwind 样式。有人质疑其[可维护性](https://twitter.com/hi__mayank/status/1584261503670448128)，但在实践中效果相当好。

**[Qwik React](https://qwik.builder.io/qwikcity/integrations/react/)**

Qwik 是一个创新的 SPA 框架，能够[避免与客户端水合相关的性能问题](https://www.builder.io/blog/hydration-is-pure-overhead)。现在它可以通过 `qwikify$()` 函数集成 React，用于包装任何现有的 React 组件。`client:` 指令（灵感源于 Astro）允许以高度细粒度控制 React 组件的水合时机。该演示将 Material UI 集成到 Qwik 应用中。另可参阅[此视频](https://www.youtube.com/watch?v=fLH28rDu97I)。我认为这是避免完全投入这个新框架，并逐步尝试的好方案。在保持 React 跨平台特性的同时，也能采用 Qwik 来提升 Web 端性能。

**[完全类型化的 Web 应用](https://www.epicweb.dev/fully-typed-web-apps)**

Kent C. Dodds 阐述了实现端到端类型安全的重要性——从数据库到 UI，跨越不同边界：网络、本地存储、数据库等。他探讨了验证（模式、类型守卫）、类型生成（Prisma）和约定（Remix），并解释如何通过 Remix 的推断功能实现这种体验：使用 `typeof` 比 `as` 更优。

**[在 Next.js 中构建交互式 WebGL 体验](https://vercel.com/blog/building-an-interactive-webgl-experience-in-next-js)**

Vercel 阐述了如何基于 React-Three-Fiber 为 Next.js 大会创建[令人印象深刻的沉浸式注册体验](https://nextjs.org/conf)。若缺乏 3D/WebGL/Three.js 经验，理解其实现仍较复杂，但分步解构的方式颇具启发性，揭示了创意开发的思维模式。

- 👀 [React Cache API Pull-Request](https://github.com/facebook/react/pull/25506)：公开了新的 `React.experimental_cache` API
- 📖 [New beta doc - cloneElement](https://twitter.com/dan_abramov/status/1582814754426433537)：新版测试文档 - cloneElement
- 📦 [Vitest Preview](https://www.vitest-preview.com/)：支持可视化调试 Vitest 测试，是 [Jest Preview](https://www.jest-preview.com/) 的轻量版
- 📦 [Outstatic - Next.js 静态 CMS](https://outstatic.com/)：新型 Git 驱动的 CMS，完美集成 Next.js。提供简洁的用户编辑界面，支持图片上传
- 📜 [Netlify - Next.js 后台与定时 API 路由](https://www.netlify.com/blog/new-background-scheduled-api-routes-nextjs/)：Netlify 利用后台函数按 cron 表达式调用 Next.js API
- 📜 [Cloudflare Pages 支持 Next.js Edge Runtime](https://blog.cloudflare.com/next-on-pages/)：Cloudflare 现支持 Next.js，但仅限可运行于 Cloudflare Workers 的 `experimental-edge` 运行时（区别于 Node.js 运行时）。该方案基于 [Vercel Build Output API](https://vercel.com/blog/build-output-api)，有望提升边缘优先框架在多云环境的可移植性
- 📜 [Microsoft - 在 Azure 静态 Web 应用中扩展 Next.js 支持](https://techcommunity.microsoft.com/t5/apps-on-azure-blog/extending-next-js-support-in-azure-static-web-apps/ba-p/3627975)：Azure 现支持 Next.js SSR（此前仅支持 SSG）
- 📜 [Remix 表单提交后保留输入值](https://sergiodxa.com/articles/persist-inputs-after-a-form-submit-in-remix)：提出渐进增强方案，在提交后保留表单值。两种方法：在 Remix action 中返回值或使用 flash session
- 📜 [Next.js 中的柯里化布局组件模式](https://creativedesignsguru.com/currying-nextjs-layout/)：建议参数化 Next.js 的 `getLayout` 来创建布局变体，避免卸载/重载。当前是实用技巧，但随着嵌套布局支持可能减弱其必要性
- 📜 [Remix 中抛出响应与返回响应](https://sergiodxa.com/articles/throwing-vs-returning-responses-in-remix)
- 📜 [迁移至 Recoil.js 的经验教训](https://kitemaker.co/blog/lessons-learned-from-moving-to-recoil)
- 📜 [React 应用中的 API 层分离](https://profy.dev/article/react-architecture-api-layer)
- 🎥 [React 新 use 钩子是否易引发问题？](https://www.youtube.com/watch?v=ytXM05PVcFU)
- 🎥 [React Advanced 伦敦 2022 - 第一天](https://www.youtube.com/watch?v=1x7mI_xuVVo)
- 🧵 [Lottie 与 Rive 对比](https://twitter.com/guidorosso/status/1582086637328031745)：Lottie 在 React 生态中颇受欢迎，但其竞争对手 Rive 在运行时性能表现更优
- 🐦 [Zustand 代码示例推文](https://twitter.com/dai_shi/status/1583082766081531905)
- 🔗 [Storybook 新版网站](https://twitter.com/storybookjs/status/1583175829009289216)

<SubscribeFormEmbed />

---

## 💸 赞助商 {#sponsor2}

[![Sunsama - 数千名软件工程师如何高效工作而不倦怠](/emails/issues/121/sunsama.jpg)](https://www.sunsama.com/a/this-week-in-react)

**[数千名软件工程师如何高效工作而不倦怠](https://www.sunsama.com/a/this-week-in-react)**

您深知工作成果的价值远胜于投入时长。**[Sunsama](https://www.sunsama.com/a/this-week-in-react)** 已成为数千名开发者的内部秘诀，助其减少工时却提升产出。

通过集成JIRA、Github和Notion消除无休止的标签切换。规划每日时间盒，为兴趣爱好和副业创造空间。

最棒的是？他们提供**[14天免费试用](https://www.sunsama.com/a/this-week-in-react)**（无需信用卡），让您今天就能开始高效产出。

---

## 📱 React-Native {#react-native}

- 🎥 [Headspace播放器 - "能用React Native实现吗？"](https://www.youtube.com/watch?v=pErnuAx5GjE)：第五季今日开播 🤗
- 🤫 [关于Expo SDK 47的传言](https://twitter.com/tsapeta/status/1582831949030522881)：令人期待的SDK！
- 🗣 [新架构已来...接下来怎么办？3.0版](https://twitter.com/Kelset/status/1583416697741975552)：Lorenzo（微软）在React Advanced的演讲幻灯片
- 📈 [React-Native性能基准测试](https://twitter.com/almouro/status/1584628478963777537)：Alexandre每日进行基准测试，比较新旧架构在各种场景下的性能
- 📖 [Reassure文档](https://callstack.github.io/reassure/)：Reassure全新Docusaurus文档站点上线 🤗
- 📖 [Expo文档更新 - 全新Flipper插件集成指南](https://twitter.com/amanhimself/status/1583202477469765633)
- 📦 [create-react-native-library 0.25](https://twitter.com/satya164/status/1583462129235263490)：Kotlin Turbo模块模板
- 📦 [Expo Router 0.0.31](https://twitter.com/Baconbrix/status/1582875434567409664)
- 📦 [Expo Router 0.0.33](https://twitter.com/Baconbrix/status/1584289284713947136)
- 📦 [Realm JavaScript v11 - 支持Hermes、Realm React、Flipper等](https://www.mongodb.com/developer/products/realm/realm-javascript-v11-react-native/)
- 🎙️ [RNR 249 - Redux维护者对RTK vs MST的见解](https://reactnativeradio.com/episodes/rnr-249-a-redux-maintainers-thoughts-on-rtk-vs-mst)

---

## 🧑‍💻 职位招聘 {#jobs}

🧑‍💼 [**Causal产品工程师，远程/伦敦/纽约，$150-250k**](https://jobs.lever.co/causal-app/4acaafbe-ef3d-45a6-bbe6-687c022d727c?lever-origin=applied&lever-source%5B%5D=thisweekinreact.com)

Causal是A轮初创公司（获Coatue/Accel投资），正在构建集数字处理与数据可视化于一体的工具。我们寻求能解决复杂UX/性能挑战的资深React工程师。

🧑‍💼 [**G2i - 100%远程React Native职位**](https://twitter.com/gabe_g2i/status/1563204813881425926?s=20&t=ArRLC77BpRwXXCdx8fnUqw)

我们开放多个专注React Native开发的职位！薪资约16万美元加10%奖金。需具备RN生产环境经验且位于美国境内。私信[@gabe_g2i](https://twitter.com/gabe_g2i)了解详情，请提及This Week in React。

💡 [如何发布招聘信息？](https://thisweekinreact.com/sponsor)

---

## 🔀 其他 {#other}

- [聊聊 Web Components](https://bradfrost.com/blog/post/lets-talk-about-web-components/)：Brad Frost 关于 Web Components 的有趣解读，它们并非与 React 不兼容，而是能相互补充（例如在 React 应用中构建设计系统）。当前的 SSR 兼容性问题终将被解决。
- [Replit 应用](https://twitter.com/amasad/status/1582754714575257600)：手机端编程新应用（基于 [Expo](https://twitter.com/amasad/status/1582968657675661314) 开发），提供 Next.js 编码模板。
- [Node.js 19 发布](https://www.redhat.com/en/blog/introducing-nodejs-19) - 注：Node.js 18 今日起进入 LTS 阶段！
- [Stately Studio 1.0 发布](https://stately.ai/blog/introducing-stately-studio-10)：XState 状态机编辑器
- [Vite 4 规划](https://github.com/vitejs/vite/discussions/10570)：升级至 Rollup 3，支持 es2020 兼容性...
- [ViteConf 2022 回放](https://viteconf.org/2022/replay)
- [Turborepo 1.6 - 支持在非单体仓库中使用](https://twitter.com/turborepo/status/1583518617970233346)
- [Solid 1.6 发布](https://twitter.com/solid_js/status/1583016386984480768)
- [未来派 CSS](https://www.smashingmagazine.com/2022/10/futuristic-css/)
- [现在 CSS 是否过于复杂？](https://css-tricks.com/is-there-too-much-css-now/)
- [npm bin 脚本混淆：滥用 'bin' 劫持 'node' 命令](https://socket.dev/blog/npm-bin-script-confusion)
- [Tailwind CSS v3.2：动态断点、多配置与容器查询](https://twitter.com/adamwathan/status/1582793658168152065)
- [Tailwind CSS v3.2：再谈"功能蔓延"警告](https://www.brycewray.com/posts/2022/10/tailwind-css-v3-2-revisiting-feature-creep-warning/)
- [Can I DevTools - 浏览器开发者工具功能对比](https://canidev.tools)
- [Vercel - 区域性边缘函数](https://vercel.com/blog/regional-execution-for-ultra-low-latency-rendering-at-the-edge)
- [Deno - 哪个无服务器边缘平台的 Git 部署最快？](https://deno.com/blog/fastest-git-deploys-to-the-edge)
- [Cloudflare Workers 与微前端：天生绝配](https://blog.cloudflare.com/better-micro-frontends/)
- [Blink：计划支持 CSS 颜色模块 Level 4 及 color-mix()](https://twitter.com/intenttoship/status/1583110354074116096)
- [Safari 技术预览版 156 发布说明](https://webkit.org/blog/13394/release-notes-for-safari-technology-preview-156/)
- [Safari 16.1 中的 WebKit 特性](https://webkit.org/blog/13399/webkit-features-in-safari-16-1/)
- [使用 2022-03 装饰器 API 实现 JavaScript 元编程](https://2ality.com/2022/10/javascript-decorators.html)

---

## 🤭 趣闻 {#fun}

[![表情包 - iWatch 运行 VSCode](/emails/issues/121/meme.png)](https://twitter.com/rohanpdofficial/status/1583455633134977026)